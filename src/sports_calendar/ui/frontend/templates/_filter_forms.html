{% import "_lookup_field.html" as lookup %}

{% macro render_field(field) %}
  <div class="mb-3" data-path="{{ field.path }}" data-input-type="{{ field.input_type }}">
    <label class="form-label">{{ field.label }}</label>

    {% if field.input_type in ["text", "number"] %}
      <input name="{{ field.path }}" type="{{ field.input_type }}" class="form-control" value="{{ field.current_display[0] }}">

    {% elif field.input_type in ["select", "multiselect"] %}
      {% if field.input_type == "multiselect" %}
        <select name="{{ field.path }}" class="form-select" multiple>
      {% else %}
        <select name="{{ field.path }}" class="form-select">
      {% endif %}
      {% for opt in field.select_options %}
        <option value="{{ opt.value }}" {% if opt.value in field.current_value %}selected{% endif %}>
          {{ opt.display }}
        </option>
      {% endfor %}
      </select>

    {% elif field.input_type in ["lookup", "multilookup"] %}
      {% if field.input_type == "lookup" %}
        {{ lookup.lookup_field(
            label=field.label,
            path=field.path,
            value=field.current_display[0] if field.current_display else "",
            lookup_endpoint=field.lookup_endpoint
        ) }}
      {% else %}
      <!-- Placeholder... -->
      <input name="{{ field.path }}" type="text" class="form-control" value="{{ field.current_display | join(', ') }}">
      {% endif %}
    {% endif %}
  </div>
{% endmacro %}